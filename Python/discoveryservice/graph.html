<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Aarc Graph</title>
    <meta name="description" content="Getting graph into Browser.">
    <link href="https://fonts.googleapis.com/css?family=Simonetta&amp;display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://unpkg.com/draggabilly@2/dist/draggabilly.pkgd.min.js"></script>
    <script src="js/FileSaver.js"></script>

    <!-- FAVICONS -->
    <link rel="shortcut icon" href="image/AARCLogo256x256_black_transparent.png">

</head>

<body>
    <h1>Aarc Graph</h1>

    <div class="buttonStuff" style="width: 1200px;">
        <button type="button" class="aarcButton" onclick="loadXml()"><span>Load Xml</span></button>
        <button type="button" class="aarcButton" onclick="saveXml()"><span>Save Xml</span></button>
        <button type="button" class="aarcButton" onclick="deselectAll()"><span>Deselect All</span></button>
        <button type="button" class="aarcButton" onclick="loadJsonFromFile()"><span>Load Json</span></button>
        <button type="button" class="aarcButton" onclick="updateNodes()"><span>DS Nodes</span></button>
        <input id="file-input" type="file" name="name" style="display: none;" />
    </div>

    <!-- container2 holds background color with some transparency - see main.css for examples -->
    <div id="container2" style="width: 1198px;height: 398px; border: 1px solid #555;"></div>
    <!-- container1 holds the canvas and the background image -->
    <div id="container1" style="width: 1200px; height: 415px; overflow: hidden;">
        <canvas id="canvasBase" width="1200" height="400"></canvas>
        <div class="draggable" style="width: 1200px; height: 15px; top: -3px; background: #222;">
            <div id="dragHandle" style="background: #33333a; border: 1px solid rgb(215,100,40); height: 13px; width: 1198px; cursor: row-resize;">
            </div>

            <!-- 255, 238, 221 -->
            <div class="slidePanel" style="height: 402px">
                <div style="padding: 10px 20px; font-family: consolas; font-size: 12px">
                    &#9632; shift-mousewheel to zoom graph<br>
                    &#9632; left click nodes and edges to toggle selection<br>
                    &#9632; right click objects for context menus<br>
                </div>

                <!-- more stuff here -->

                <div style="border: 1px solid #777; height: 82px; width: 1002px; margin-left: 20px;">
                    <textarea id="nodeDef" autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; padding: 0px; width: 1000px; height: 80px; outline: none; resize: none; white-space: nowrap;" tabindex="0">System.Double[] GetVols(System.String ticker, System.DateTime from, System.DateTime to)</textarea>
                </div>
                <button type="button" class="aarcButton" onclick="addNode()" style="margin-left: 20px; margin-top: 5px;"><span>Add Node</span></button>
                <button type="button" class="aarcButton" onclick="addJson()"><span>Add Json</span></button>
                <button type="button" class="aarcButton" onclick="nodeText()"><span>Get Selected</span></button>

                <div style="padding: 10px 20px; font-family: consolas; font-size: 12px">
                    &#9632; Type a prototype for the node above and click the 'Add Node' button.<br>
                    &nbsp; Example: System.Double[] GetVols(System.String ticker, System.DateTime from, System.DateTime to)<br>
                    &nbsp; Use 'void' for no return type, e.g. void DoStuff({type} {paramName})<br>
                    &nbsp; Multiple function prototypes may be separated by ';'<br>
                    &#9632; Click 'Get Selected' to set the text from the selected nodes in the graph.<br>
                </div>

                <!-- end stuff here -->
            </div>
        </div>
    </div>
    <div class="aarcNode-title" style="width: 1198px; border: 1px solid #555;">
        <span style="padding-left: 10px;">Copyright AARC Capital 2019</span>
    </div>

    <div class="menu">
        <ul class="menu-options">
            <li class="menu-option">Delete</li>
            <li class="menu-option">Reload</li>
        </ul>
    </div>

    <script type="text/javascript" src="js/grid.js"></script>
    <script type="text/javascript" src="js/graphDecorator.js"></script>
    <script type="text/javascript" src="js/graphnode.js"></script>
    <script type="text/javascript" src="js/contextMenu.js"></script>
    <script type="text/javascript">
        // sets up variables, and adds event handlers
        init();

        var draggie = new Draggabilly('.draggable', {
            // options...
            containment: '#container1',
            handle: '#dragHandle',
            axis: 'y'
        });

function updateNodes()
{
    jQuery.getJSON("/api/outputchannels", function(data)
    {
        console.log(JSON.stringify(data));
        data.forEach(json => {
                let node = GraphNode.fromJson(json)
                graph.add(node);
        });
        graph.draw(ctx);
    });
}
    </script>

</body>

</html>
